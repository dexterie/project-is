import streamlit as st
from PIL import Image
import pickle
import numpy as np
import tensorflow as tf
from tensorflow.keras.preprocessing.image import load_img, img_to_array
from tensorflow.keras.applications.mobilenet_v2 import preprocess_input


st.set_page_config(page_title="ML & NN", layout="wide")
tab1, tab2, tab3, tab4 = st.tabs(["Machine Learning", "Neural Network", "Demo Machine Learning", "Demo Neural Network"])

with open("model/svm_model.pkl", "rb") as file:
    svm_model = pickle.load(file)

with open("model/rf_model.pkl", "rb") as file:
    rf_model = pickle.load(file)

with tab1:
    import streamlit as st

    st.write("‡∏ú‡∏°‡πÑ‡∏î‡πâ‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡πÄ‡∏ß‡πá‡∏ö Kaggle ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏•‡∏≤‡∏¢‡πÜ ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏ß‡πâ ‡∏ú‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å  "
    "[Heart Disease Dataset](https://www.kaggle.com/datasets/johnsmith88/heart-disease-dataset)")

    st.title("‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö")
    st.write("‡πÇ‡∏£‡∏Ñ‡∏´‡∏±‡∏ß‡πÉ‡∏à ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏Ñ‡∏∏‡∏ì‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏†‡∏≤‡∏û ‡πÅ‡∏•‡∏∞‡∏ú‡∏•‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏• ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏õ‡∏±‡∏à‡∏à‡∏±‡∏¢‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏à‡∏≤‡∏Å‡πÇ‡∏£‡∏Ñ‡∏´‡∏±‡∏ß‡πÉ‡∏à ‡πÑ‡∏î‡πâ‡πÅ‡∏Å‡πà "
             "‡πÄ‡∏ä‡πà‡∏ô ‡∏≠‡∏≤‡∏¢‡∏∏, ‡πÄ‡∏û‡∏®, ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏≠‡πÄ‡∏•‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡∏≠‡∏•, ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡πÇ‡∏•‡∏´‡∏¥‡∏ï, ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡πâ‡∏ô‡∏Ç‡∏≠‡∏á‡∏´‡∏±‡∏ß‡πÉ‡∏à")
    
    st.title("Features ‡∏°‡∏µ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ")
    st.markdown("""
    - **age**: ‡∏≠‡∏≤‡∏¢‡∏∏‡∏Ç‡∏≠‡∏á‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•
    - **sex**: ‡πÄ‡∏û‡∏® (1 = ‡∏ä‡∏≤‡∏¢, 0 = ‡∏´‡∏ç‡∏¥‡∏á)
    - **cp**: ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏≠‡∏á‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏à‡πá‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏Å (‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà 0 ‡∏ñ‡∏∂‡∏á 3)
      - 0: ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£
      - 1: ‡πÄ‡∏à‡πá‡∏ö‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á
      - 2: ‡πÄ‡∏à‡πá‡∏ö‡πÅ‡∏ö‡∏ö‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á
      - 3: ‡πÄ‡∏à‡πá‡∏ö‡∏°‡∏≤‡∏Å
    - **trestbps**: ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡πÇ‡∏•‡∏´‡∏¥‡∏ï‡∏Ç‡∏ì‡∏∞‡∏û‡∏±‡∏Å (mm Hg)
    - **chol**: ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏≠‡πÄ‡∏•‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡∏≠‡∏•‡πÉ‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏î (mg/dl)
    - **fbs**: ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡πÉ‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏Ç‡∏ì‡∏∞‡∏≠‡∏î‡∏≠‡∏≤‡∏´‡∏≤‡∏£ (>120 mg/dl)
      - 0 = ‡∏õ‡∏Å‡∏ï‡∏¥
      - 1 = ‡∏™‡∏π‡∏á
    - **restecg**: ‡∏ú‡∏•‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏´‡∏±‡∏ß‡πÉ‡∏à (ECG)
      - 0: ‡∏õ‡∏Å‡∏ï‡∏¥
      - 1: ‡∏°‡∏µ ST-T wave abnormality
      - 2: ‡πÅ‡∏™‡∏î‡∏á‡∏†‡∏≤‡∏ß‡∏∞ ventricular hypertrophy
    - **thalach**: ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡πâ‡∏ô‡∏Ç‡∏≠‡∏á‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏î‡πÑ‡∏î‡πâ (bpm)
    - **exang**: ‡∏°‡∏µ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏à‡πá‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏Å‡∏Ç‡∏ì‡∏∞‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
      - 0 = ‡πÑ‡∏°‡πà‡∏°‡∏µ
      - 1 = ‡∏°‡∏µ
    - **oldpeak**: ‡∏£‡∏∞‡∏î‡∏±‡∏ö ST depression (‡∏Ñ‡πà‡∏≤‡∏•‡∏î‡∏•‡∏á‡∏Ç‡∏≠‡∏á ST segment ‡πÉ‡∏ô ECG)
    - **slope**: ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏Ç‡∏≠‡∏á ST segment slope
      - 0: Upsloping
      - 1: Flat
      - 2: Downsloping
    - **ca**: ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏•‡∏≠‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏™‡∏µ (‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà 0 ‡∏ñ‡∏∂‡∏á 4)
    - **thal**: ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏≠‡∏á Thalassemia
      - 0: ‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏Ñ‡πà‡∏≤
      - 1: Fixed defect (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥‡∏ñ‡∏≤‡∏ß‡∏£)
      - 2: Normal (‡∏õ‡∏Å‡∏ï‡∏¥)
      - 3: Reversible defect (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥‡∏ó‡∏µ‡πà‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥‡πÑ‡∏î‡πâ)
    """)

    st.title("Target")
    st.markdown("""
    - **target**: ‡∏°‡∏µ‡∏†‡∏≤‡∏ß‡∏∞‡πÇ‡∏£‡∏Ñ‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
      - 0 = ‡∏õ‡∏Å‡∏ï‡∏¥ (‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÇ‡∏£‡∏Ñ‡∏´‡∏±‡∏ß‡πÉ‡∏à)
      - 1 = ‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏£‡∏Ñ‡∏´‡∏±‡∏ß‡πÉ‡∏à
    """)

    st.write("‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏£‡∏Å‡∏ú‡∏°‡πÑ‡∏î‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• head and tail ‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ß‡πà‡∏≤ ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤ Nan ‡∏°‡∏±‡πâ‡∏¢ ‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ñ‡πà‡∏≤ Nan", unsafe_allow_html=True)
    st.image("photo/check_dataset_svm1.png")

    st.write("‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏ú‡∏°‡∏Å‡πá‡∏°‡∏≤‡∏î‡∏π‡πÅ‡∏ï‡πà‡∏•‡∏∞ Column ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤ Null ‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà ‡πÅ‡∏•‡πâ‡∏ß Sum ‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡∏î‡∏π‡∏à‡∏≥‡∏ô‡∏ß‡∏ô", unsafe_allow_html=True)
    st.image("photo/null_sum.png")

    st.write("‡∏û‡∏≠‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡πà‡∏≤ Null ‡∏ú‡∏°‡πÄ‡∏•‡∏¢‡πÑ‡∏î‡πâ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡πà‡∏≤‡∏´‡∏≤‡∏¢ ‡πÉ‡∏ä‡πâ ‡∏Ñ‡πà‡∏≤‡∏°‡∏±‡∏ò‡∏¢‡∏ê‡∏≤‡∏ô (median) ‡πÄ‡∏ï‡∏¥‡∏°‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 'chol' ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡∏Ñ‡πà‡∏≤ outlier ‡πÑ‡∏î‡πâ"
    "‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡πà‡∏≠‡∏°‡∏≤‡πÑ‡∏î‡πâ‡∏ó‡∏≥ ‡∏•‡∏ö‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡∏°‡∏µ missing values ‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏¥‡∏°‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏•‡∏∞ ‡∏•‡∏ö‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏Å‡∏¥‡∏ô 50% ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ñ‡∏ß‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î", unsafe_allow_html=True)
    st.image("photo/put_data.png")

    st.write("‡πÅ‡∏õ‡∏•‡∏á‡∏Ñ‡πà‡∏≤ Target ‡πÄ‡∏õ‡πá‡∏ô 0 ‡πÅ‡∏•‡∏∞ 1 ‡πÅ‡∏•‡πâ‡∏ß‡∏ñ‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 0.5 ‡∏à‡∏∞‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏õ‡πá‡∏ô 1 ‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô 0", unsafe_allow_html=True)
    st.image("photo/target.png")

    st.write("‡∏ú‡∏°‡πÅ‡∏¢‡∏Å featrures ‡πÅ‡∏•‡∏∞ Target "
    "‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏Å‡πá‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ split ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô train 80% ‡∏Å‡∏±‡∏ö test 20% ‡πÇ‡∏î‡∏¢‡πÉ‡∏´‡πâ random state = 42", unsafe_allow_html=True)
    st.image("photo/spilt.png")

    st.write("‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏ú‡∏°‡∏Å‡πá‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ model Support Vector Regression ‡πÇ‡∏î‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î‡∏Ç‡∏≠‡∏á Support Vector Machine ‡∏Å‡∏±‡∏ö Classification "
    "‡πÄ‡∏û‡∏£‡∏≤‡∏∞ ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÅ‡∏¢‡∏Å‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ‡∏î‡∏µ‡πÉ‡∏ô‡πÄ‡∏ä‡∏¥‡∏á‡πÄ‡∏™‡πâ‡∏ô ‡∏ï‡πà‡∏≠‡∏°‡∏≤‡∏ú‡∏°‡∏Å‡πá‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ model RandomForest ‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏±‡∏•‡∏Å‡∏≠‡∏£‡∏¥‡∏ò‡∏∂‡∏° Machine Learning ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ ‡∏Å‡∏≤‡∏£‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡∏´‡∏•‡∏≤‡∏¢‡πÜ Decision Trees ‡πÇ‡∏î‡∏¢ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏•‡∏≤‡∏¢‡πÜ Decision Trees"
    " ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏™‡∏∏‡πà‡∏°‡∏°‡∏≤ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô'", unsafe_allow_html=True)
    st.image("photo/Train.png")
    
with tab2:
    st.write("‡∏ú‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏´‡∏≤‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏†‡∏≤‡∏¢‡πÉ‡∏ô Kaggle ‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "
    "dataset ‡∏Ç‡∏≠‡∏á [Cats-vs-Dogs](https://www.kaggle.com/datasets/shaunthesheep/microsoft-catsvsdogs-dataset/data)"
    "")
    st.title("‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö")
    st.write("‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏¢‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ß‡πà‡∏≤ ‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏ä‡∏ô‡∏¥‡∏î‡πÑ‡∏´‡∏ô '‡∏´‡∏°‡∏≤' ‡∏´‡∏£‡∏∑‡∏≠ '‡πÅ‡∏°‡∏ß' ‡∏ä‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ô20000‡∏†‡∏≤‡∏û")
    st.title("Features ‡∏°‡∏µ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ")
    st.markdown("""
    - **‡∏£‡∏π‡∏õ‡πÅ‡∏°‡∏ß**: 10000‡∏£‡∏π‡∏õ
    - **‡∏£‡∏π‡∏õ‡∏´‡∏°‡∏≤**: 10000‡∏£‡∏π‡∏õ
    - **‡πÅ‡∏ï‡πà‡∏ú‡∏°‡∏ô‡∏≥‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡∏£‡∏¥‡∏á‡πÅ‡∏Ñ‡πà 1040 ‡∏£‡∏π‡∏õ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞ ‡∏ú‡∏°‡∏Å‡∏•‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏±‡∏ô‡∏à‡∏∞‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ 
    """)
    st.image("photo/dog-cat.jpg")
    
    st.write("‡∏ú‡∏°‡πÑ‡∏î‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ dataset ‡∏°‡∏µ‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏õ‡∏•‡∏Å‡∏õ‡∏•‡∏≠‡∏°")
    st.image("photo/nn7.png")

    st.write("‡∏ï‡πà‡∏≠‡∏°‡∏≤‡∏ú‡∏°‡πÑ‡∏î‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏†‡∏≤‡∏û‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á‡∏Å‡∏±‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏°‡∏µ‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢‡∏°‡∏±‡πâ‡∏¢")
    st.image("photo/nn6.png")

    st.write("‡∏≠‡πà‡∏≤‡∏ô‡∏†‡∏≤‡∏û‡∏à‡∏≤‡∏Å‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå Cat ‡πÅ‡∏•‡∏∞ Dog ‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡πÅ‡∏¢‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå jpg, png, jpeg ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û 1040‡∏£‡∏π‡∏õ ‡∏Ç‡∏ô‡∏≤‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û 224x224 ‡πÅ‡∏•‡∏∞ ‡πÅ‡∏õ‡∏•‡∏á‡∏õ‡πâ‡∏≤‡∏¢‡∏Å‡∏≥‡∏Å‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô 1 (Dog) ‡πÅ‡∏•‡∏∞ 0 (Cat)", unsafe_allow_html=True)
    st.image("photo/nn1.png")

    st.write("‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û 520‡∏£‡∏π‡∏õ‡∏ï‡πà‡∏≠‡∏Ñ‡∏•‡∏≤‡∏™ ‡πÅ‡∏•‡∏∞ ‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏≤‡∏£‡πå‡πÄ‡∏£‡∏¢‡πå data ‡πÅ‡∏•‡∏∞ labels", unsafe_allow_html=True)
    st.image("photo/nn2.png")

    st.write("‡πÉ‡∏ä‡πâ ImageDataGenerator ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏†‡∏≤‡∏û‡πÇ‡∏î‡∏¢ ‡∏´‡∏°‡∏∏‡∏ô‡∏†‡∏≤‡∏û‡∏™‡∏∏‡πà‡∏° ,‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏†‡∏≤‡∏û‡∏™‡∏∏‡πà‡∏°, ‡∏Ç‡∏¢‡∏≤‡∏¢/‡∏¢‡πà‡∏≠‡∏†‡∏≤‡∏û, ‡∏û‡∏•‡∏¥‡∏Å‡∏†‡∏≤‡∏û", unsafe_allow_html=True)
    st.image("photo/nn3.png")

    st.write("‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏°‡πÄ‡∏î‡∏• MobileNetV2 ‡πÅ‡∏•‡∏∞‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ Fine-Tuning ‡∏•‡πá‡∏≠‡∏Å‡πÄ‡∏•‡πÄ‡∏¢‡∏≠‡∏£‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô 30 ‡πÄ‡∏•‡πÄ‡∏¢‡∏≠‡∏£‡πå‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢ ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏°‡πÄ‡∏î‡∏•"
    "‡πÉ‡∏ä‡πâ GlobalAveragePooling2D ‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡πÅ‡∏°‡∏û,‡πÄ‡∏û‡∏¥‡πà‡∏° Dense Layer ‡∏Ç‡∏ô‡∏≤‡∏î 128 ‡∏ô‡∏¥‡∏ß‡∏£‡∏≠‡∏ô, ‡πÉ‡∏ä‡πâDropout 0.5 ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô Overfitting ‡πÉ‡∏ä‡πâ Optimizer Adam(learning_rate=0.00001)", unsafe_allow_html=True)
    st.image("photo/nn4.png")

    st.write("‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏°‡∏≤‡∏ù‡∏∂‡∏Å‡πÇ‡∏°‡πÄ‡∏î‡∏•‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ Data Augmentation ‡∏Å‡∏≥‡∏´‡∏ô‡∏î batch_size = 32 ‡πÅ‡∏•‡∏∞ ‡πÉ‡∏ä‡πâ 10 epochs", unsafe_allow_html=True)
    st.image("photo/nn5.png")

with tab3:
      st.title("Demo Machine Learning: Heart Disease Prediction")
      model_choice = st.radio("‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ", ["SVM", "Random Forest"])

      # ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
      age = st.number_input("‡∏≠‡∏≤‡∏¢‡∏∏", min_value=20, max_value=100, value=50)
      sex = st.selectbox("‡πÄ‡∏û‡∏®", [("‡∏ä‡∏≤‡∏¢", 1), ("‡∏´‡∏ç‡∏¥‡∏á", 0)], format_func=lambda x: x[0])[1]
      cp = st.selectbox("‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏à‡πá‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏Å", [("‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£", 0), ("‡πÄ‡∏à‡πá‡∏ö‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á", 1), ("‡πÄ‡∏à‡πá‡∏ö‡πÅ‡∏ö‡∏ö‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á", 2), ("‡πÄ‡∏à‡πá‡∏ö‡∏°‡∏≤‡∏Å", 3)], format_func=lambda x: x[0])[1]
      trestbps = st.number_input("‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡πÇ‡∏•‡∏´‡∏¥‡∏ï‡∏Ç‡∏ì‡∏∞‡∏û‡∏±‡∏Å (mm Hg)", min_value=80, max_value=200, value=120)
      chol = st.number_input("‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏≠‡πÄ‡∏•‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡∏≠‡∏• (mg/dl)", min_value=100, max_value=400, value=200)
      fbs = st.selectbox("‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•‡πÉ‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏Ç‡∏ì‡∏∞‡∏≠‡∏î‡∏≠‡∏≤‡∏´‡∏≤‡∏£", [("‡∏õ‡∏Å‡∏ï‡∏¥", 0), ("‡∏™‡∏π‡∏á", 1)], format_func=lambda x: x[0])[1]
      restecg = st.selectbox("‡∏ú‡∏•‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏´‡∏±‡∏ß‡πÉ‡∏à", [("‡∏õ‡∏Å‡∏ï‡∏¥", 0), ("ST-T wave abnormality", 1), ("ventricular hypertrophy", 2)], format_func=lambda x: x[0])[1]
      thalach = st.number_input("‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡πâ‡∏ô‡∏Ç‡∏≠‡∏á‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏î‡πÑ‡∏î‡πâ (bpm)", min_value=50, max_value=220, value=150)
      exang = st.selectbox("‡∏°‡∏µ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏à‡πá‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏Å‡∏Ç‡∏ì‡∏∞‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà", [("‡πÑ‡∏°‡πà‡∏°‡∏µ", 0), ("‡∏°‡∏µ", 1)], format_func=lambda x: x[0])[1]
      oldpeak = st.number_input("‡∏£‡∏∞‡∏î‡∏±‡∏ö ST depression", min_value=0.0, max_value=6.0, value=1.0, step=0.1)
      slope = st.selectbox("‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏Ç‡∏≠‡∏á ST segment slope", [("Upsloping", 0), ("Flat", 1), ("Downsloping", 2)], format_func=lambda x: x[0])[1]
      ca = st.number_input("‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏•‡∏≠‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏™‡∏µ", min_value=0, max_value=4, value=1)
      thal = st.selectbox("‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏≠‡∏á Thalassemia", [("‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏Ñ‡πà‡∏≤", 0), ("Fixed defect", 1), ("Normal", 2), ("Reversible defect", 3)], format_func=lambda x: x[0])[1]

      # ‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢
      if st.button("Prediction"):
          input_features = np.array([[age, sex, cp, trestbps, chol, fbs, restecg, thalach, exang, oldpeak, slope, ca, thal]])

          if model_choice == "SVM":
              prediction = svm_model.predict(input_features)[0]
          else:
              prediction = rf_model.predict(input_features)[0]

          if prediction == 1:
            st.error(f"‚ö†Ô∏è ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏£‡∏Ñ‡∏´‡∏±‡∏ß‡πÉ‡∏à ({model_choice} Model)")
          else:
            st.success(f"‚úÖ ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏†‡∏≤‡∏ß‡∏∞‡πÇ‡∏£‡∏Ñ‡∏´‡∏±‡∏ß‡πÉ‡∏à ({model_choice} Model)")

with tab4:
    st.title("Demo Neural Network")
    st.title("üê∂üê± Cat vs Dog Classifier")
    st.write("<h4 style='text-align: ;'>MobilenetV2</h4>", unsafe_allow_html=True)
    st.image("photo/Graph.png")

    # ‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏°‡πÄ‡∏î‡∏•
    model = tf.keras.models.load_model("model/mobilenetv2_cat_dog.h5")

    # ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏†‡∏≤‡∏û
    def predict_image(image):
        img = Image.open(image)  # ‡πÄ‡∏õ‡∏¥‡∏î‡∏†‡∏≤‡∏û‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î
        img = img.resize((224, 224))  # Resize ‡∏†‡∏≤‡∏û‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏°‡πÄ‡∏î‡∏•
        img_array = img_to_array(img)  # ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô array
        img_array = preprocess_input(img_array)  # ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏ï‡∏≤‡∏° MobileNetV2
        img_array = np.expand_dims(img_array, axis=0)  # ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏°‡∏¥‡∏ï‡∏¥‡πÉ‡∏´‡πâ TensorFlow ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ

        prediction = model.predict(img_array)[0][0]  # ‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏ú‡∏•
        return "üê∂ Dog" if prediction > 0.5 else "üê± Cat"

    # ‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏û‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÉ‡∏ô tab4
    uploaded_file = st.file_uploader("üì§ Upload an image...", type=["jpg", "png", "jpeg"])

    if uploaded_file is not None:  # ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î
        st.image(uploaded_file)
        label = predict_image(uploaded_file)  # ‡∏™‡πà‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏õ‡πÉ‡∏´‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢
        st.write(f"### ‚úÖ Prediction: {label}")